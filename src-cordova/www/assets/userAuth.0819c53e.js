import{e as q,c as B,r as f,w as L,v as A,h,T as M,A as W,ae as I,af as P,ag as _,ah as j,ai as O}from"./index.85254b91.js";import{a as Q}from"./axios.f1f32898.js";const $={ratio:[String,Number]};function H(e,i){return q(()=>{const r=Number(e.ratio||(i!==void 0?i.value:void 0));return isNaN(r)!==!0&&r>0?{paddingBottom:`${100/r}%`}:null})}const K=16/9;var te=B({name:"QImg",props:{...$,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:K},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:i,emit:r}){const s=f(e.initialRatio),l=H(e,s);let n=null,c=!1;const a=[f(null),f(d())],o=f(0),y=f(!1),S=f(!1),x=q(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),E=q(()=>({width:e.width,height:e.height})),p=q(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition`),g=q(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));L(()=>u(),m);function u(){return e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null}function d(){return e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null}function m(t){n!==null&&(clearTimeout(n),n=null),S.value=!1,t===null?(y.value=!1,a[o.value^1].value=d()):y.value=!0,a[o.value].value=t}function T({target:t}){c!==!0&&(n!==null&&(clearTimeout(n),n=null),s.value=t.naturalHeight===0?.5:t.naturalWidth/t.naturalHeight,R(t,1))}function R(t,k){c===!0||k===1e3||(t.complete===!0?C(t):n=setTimeout(()=>{n=null,R(t,k+1)},50))}function C(t){c!==!0&&(o.value=o.value^1,a[o.value].value=null,y.value=!1,S.value=!1,r("load",t.currentSrc||t.src))}function w(t){n!==null&&(clearTimeout(n),n=null),y.value=!1,S.value=!0,a[o.value].value=null,a[o.value^1].value=d(),r("error",t)}function b(t){const k=a[t].value,U={key:"img_"+t,class:p.value,style:g.value,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...k};return o.value===t?(U.class+=" q-img__image--waiting",Object.assign(U,{onLoad:T,onError:w})):U.class+=" q-img__image--loaded",h("div",{class:"q-img__container absolute-full",key:"img"+t},h("img",U))}function z(){return y.value!==!0?h("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},W(i[S.value===!0?"error":"default"])):h("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},i.loading!==void 0?i.loading():e.noSpinner===!0?void 0:[h(I,{color:e.spinnerColor,size:e.spinnerSize})])}return m(u()),A(()=>{c=!0,n!==null&&(clearTimeout(n),n=null)}),()=>{const t=[];return l.value!==null&&t.push(h("div",{key:"filler",style:l.value})),S.value!==!0&&(a[0].value!==null&&t.push(b(0)),a[1].value!==null&&t.push(b(1))),t.push(h(M,{name:"q-transition--fade"},z)),h("div",{class:x.value,style:E.value,role:"img","aria-label":e.alt},t)}}});const V="https://app.form.phoenixtechsa.com/api",N=Q.create({baseURL:V,headers:{"X-Custom-Header":"foobar"}});function F({email:e,password:i}){return N.post("/login",{email:e,password:i})}function D({name:e,email:i,password:r,active:s,role_id:l,phone:n,last_name:c,sex:a,address:o}){return N.post("/register",{name:e,email:i,password:r,active:s,role_id:l,phone:n,last_name:c,sex:a,address:o})}function X({user_id:e}){return N.post("/prueba-membresia",{user_id:e})}const G=P("userAuth",{state:()=>{var e,i;return{user:((e=_.getUser())==null?void 0:e.user)||null,token:((i=_.getUser())==null?void 0:i.token)||null}},actions:{logout(){this.user=null,this.token=null,_.removeUser()},async login({email:e,password:i}){var s,l;const{data:r}=await F({email:e,password:i});this.user=r.user,this.token=r.token,_.setUser(r),((s=this.user.membresia)==null?void 0:s.status)==="activa"||((l=this.user.membresia)==null?void 0:l.days)>0?this.router.push("/home"):this.router.push("/memberships")},async register({name:e,email:i,last_name:r,phone:s,sex:l,password:n,role_id:c}){const{data:a}=await D({name:e,email:i,last_name:r,phone:s,sex:l,password:n,role_id:c});this.user=a.user,this.token=a.token,_.setUser(a),this.router.push("/memberships")},async addMembership({user_id:e}){const{data:i}=await X({user_id:e});this.user.membresia=i,console.log(i,"data de membresia"),_.setUser({user:this.user,token:this.token})}}});function J(){return j(O)}const Y=()=>{const e=J();return console.log(e,"quasar"),{triggerPositive:s=>{e.notify({type:"positive",message:s})},triggerWarning:s=>{e.notify({type:"warning",message:s})}}},v=()=>{const e=G(),i=f(!1),r=f(!1),s=f(!1),{token:l,user:n}=e;console.log(n,"user");const c=()=>{var g,u;return((g=v==null?void 0:v.user.membresia)==null?void 0:g.status)==="activa"||((u=v==null?void 0:v.user.membresia)==null?void 0:u.days)>0},{triggerPositive:a,triggerWarning:o}=Y();return{isActiveUser:()=>Boolean(v.user),membershipsIsActive:c,login:async({password:g,email:u})=>{var d;try{i.value=!0,await e.login({password:g,email:u}),a("Usuario iniciado con \xE9xito")}catch(m){((d=m.response)==null?void 0:d.status)===400&&o("Usuario no encontrado, por favor verifique sus datos e intente nuevamente"),m.code==="ERR_NETWORK"&&o("Verifique su conexi\xF3n a internet e intente nuevamente"),console.error(m)}finally{i.value=!1}},register:async({name:g,email:u,last_name:d,phone:m,sex:T,password:R,role_id:C})=>{var w;try{r.value=!0,await e.register({name:g,email:u,last_name:d,phone:m,sex:T,password:R,role_id:C}),a("Usuario registrado con \xE9xito")}catch(b){((w=b.response)==null?void 0:w.status)===400&&o("Ese usuario ya exite, por favor ingrese otro correo o n\xFAmero de tel\xE9fono"),b.code==="ERR_NETWORK"&&o("Verifique su conexi\xF3n a internet e intente nuevamente"),console.error(b)}finally{r.value=!1}},token:l,user:n,isLoadingLogin:i,isAuthenticated:()=>Boolean(l),isLoadingRegister:r,addMembership:async({user_id:g})=>{try{s.value=!0,await e.addMembership({user_id:g}),a("Ha obtenido la membres\xEDa con \xE9xito")}catch(u){u.code==="ERR_NETWORK"&&o("Verifique su conexi\xF3n a internet e intente nuevamente"),console.error(u)}finally{s.value=!1}},isLoadingMembership:s}};export{te as Q,v as u};
